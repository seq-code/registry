<%= pager(@names) %>

<table class="table table-hover table-responsive">
  <thead>
    <tr>
      <th>Name, Type</th>
      <th>Checks</th>
      <th>RDP Classification</th>
    </tr>
  </thead>
  <tbody>
    <% @names.each do |name| %>
      <% genome = name.type_genome %>
      <tr>
        <td><%= display_link(name) %>, <%= display_link(genome) %></td>
        <td class="curator-checklist">
          <% @checks[@check].each do |check_type| %>
            <% warn = name.qc_warnings[check_type] or next %>
            <%= render(
                  partial: 'checks/curator',
                  locals: { warn: warn, no_message: true, no_section: true }
                ) %>
          <% end %>
        </td>
        <td>
          <% if genome %>
            <% rdp_file = genome
               .miga_object&.result(:ssu)
               &.file_path(:classification) %>
            <% if rdp_file %>
              <% Zlib::GzipReader.open(rdp_file) |fh| %>
                <% fh.each do |ln| %>
                  <% next if ln =~ /^#/ %>
                  <% row = ln.split("\t") %>
                  <b><%= row.shift %></b>
                  <ul>
                    <% while tax = row.shift(3) %>
                      <li>
                        <%= tax[0] %>
                        <span class="text-muted">(<%= tax[2] %>)</span>
                      </li>
                    <% end %>
                  </ul>
                <% end %>
              <% end %>
            <% end %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
<%= render(partial: 'checks/curator_script') %>
<%= pager(@names) %>
